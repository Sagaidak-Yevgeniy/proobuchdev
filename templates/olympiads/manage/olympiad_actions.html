{% extends 'base.html' %}
{% load i18n %}
{% load static %}

{% block title %}{% trans 'Управление олимпиадой' %} | {{ olympiad.title }}{% endblock %}

{% block extra_head %}
<style>
    /* Основные стили */
    .sidebar {
        height: calc(100vh - 80px);
        position: sticky;
        top: 80px;
    }
    
    /* Стили для навигации */
    .sidebar-nav-item {
        border-radius: 8px;
        margin-bottom: 4px;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        padding: 10px 16px;
        color: #4b5563;
        position: relative;
        overflow: hidden;
    }
    
    .dark .sidebar-nav-item {
        color: #e5e7eb;
    }
    
    .sidebar-nav-item:hover {
        background-color: rgba(243, 244, 246, 0.8);
    }
    
    .dark .sidebar-nav-item:hover {
        background-color: rgba(55, 65, 81, 0.5);
    }
    
    .sidebar-nav-item.active {
        background-color: rgba(219, 234, 254, 0.6);
        color: #3b82f6;
        font-weight: 500;
    }
    
    .dark .sidebar-nav-item.active {
        background-color: rgba(30, 58, 138, 0.3);
        color: #93c5fd;
    }
    
    .sidebar-nav-item.active::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        background: linear-gradient(to bottom, #3b82f6, #6366f1);
        border-radius: 0 2px 2px 0;
    }
    
    .sidebar-nav-item i {
        font-size: 1.1rem;
        margin-right: 12px;
        width: 24px;
        text-align: center;
        opacity: 0.8;
    }
    
    /* Стили для разделов */
    .content-section {
        display: none !important;
    }
    
    .content-section.active {
        display: block !important;
        animation: fadeIn 0.3s ease-in-out;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    /* Стили для уведомлений */
    .notification-toast {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        animation: slideIn 0.3s ease, slideOut 0.3s ease 2.7s forwards;
    }
    
    @keyframes slideIn {
        from { transform: translateY(100%); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes slideOut {
        from { transform: translateY(0); opacity: 1; }
        to { transform: translateY(100%); opacity: 0; }
    }
    
    /* Стили для карточек */
    .olympiad-card {
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .olympiad-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    /* Стили для кнопок */
    .btn-action {
        transition: all 0.2s ease;
    }
    
    .btn-action:hover {
        transform: scale(1.05);
    }
    
    /* Иконки состояний */
    .status-badge {
        position: absolute;
        top: 10px;
        right: 10px;
    }
    
    /* Дизайн форм */
    .form-input {
        transition: border-color 0.2s ease;
    }
    
    .form-input:focus {
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    /* Индикаторы статуса */
    .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 8px;
    }
    
    .status-draft { background-color: #fbbf24; }
    .status-published { background-color: #3b82f6; }
    .status-active { background-color: #10b981; }
    .status-completed { background-color: #8b5cf6; }
    .status-archived { background-color: #9ca3af; }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6">
    <!-- Хлебные крошки -->
    <nav class="flex mb-6 text-sm text-gray-500 dark:text-gray-400">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
            <li class="inline-flex items-center">
                <a href="{% url 'home' %}" class="inline-flex items-center hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-home mr-2"></i>
                    {% trans 'Главная' %}
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                    <a href="{% url 'olympiads:olympiad_list' %}" class="hover:text-gray-700 dark:hover:text-gray-300">
                        {% trans 'Олимпиады' %}
                    </a>
                </div>
            </li>
            <li>
                <div class="flex items-center">
                    <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                    <a href="{% url 'olympiads:olympiad_manage_list' %}" class="hover:text-gray-700 dark:hover:text-gray-300">
                        {% trans 'Управление' %}
                    </a>
                </div>
            </li>
            <li>
                <div class="flex items-center">
                    <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                    <a href="{% url 'olympiads:olympiad_detail' olympiad_id=olympiad.id %}" class="hover:text-gray-700 dark:hover:text-gray-300">
                        {{ olympiad.title|truncatechars:20 }}
                    </a>
                </div>
            </li>
            <li aria-current="page">
                <div class="flex items-center">
                    <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                    <span class="text-gray-800 dark:text-gray-200" id="breadcrumb-current">
                        {% trans 'Управление' %} {{ olympiad.title|truncatechars:20 }}
                    </span>
                </div>
            </li>
        </ol>
    </nav>
    
    <!-- Шапка страницы -->
    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-xl mb-8 overflow-hidden">
        <div class="p-6 text-white">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div class="flex items-center">
                    <div class="flex items-center justify-center w-14 h-14 bg-white/20 backdrop-blur-sm rounded-xl mr-4 shadow-inner">
                        <i class="fas fa-shield-alt text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">{% trans 'Управление олимпиадой' %}</h1>
                        <div class="flex items-center mt-1">
                            <div class="status-indicator 
                                {% if olympiad.status == 'draft' %}status-draft
                                {% elif olympiad.status == 'published' %}status-published
                                {% elif olympiad.status == 'active' %}status-active
                                {% elif olympiad.status == 'completed' %}status-completed
                                {% elif olympiad.status == 'archived' %}status-archived
                                {% endif %}"></div>
                            <p class="text-purple-100">{{ olympiad.title }} <span class="opacity-70">&middot; {{ olympiad.get_status_display }}</span></p>
                        </div>
                    </div>
                </div>
                
                <div class="flex flex-wrap items-center gap-3">
                    <a href="{% url 'olympiads:olympiad_detail' olympiad_id=olympiad.id %}" class="px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white shadow-md transition-all flex items-center">
                        <i class="fas fa-eye mr-2"></i> {% trans 'Просмотр' %}
                    </a>
                    <a href="{% url 'olympiads:olympiad_manage_list' %}" class="px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white shadow-md transition-all flex items-center">
                        <i class="fas fa-list mr-2"></i> {% trans 'Все олимпиады' %}
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="grid grid-cols-1 lg:grid-cols-4 xl:grid-cols-5 gap-8">
        <!-- Левая колонка с навигацией -->
        <div class="lg:col-span-1">
            <div class="sidebar space-y-6">
                <!-- Навигация по разделам -->
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-750">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">{% trans 'Навигация' %}</h3>
                    </div>
                    <div class="p-3">
                        <nav>
                            <a href="#overview" data-section="overview" class="sidebar-nav-item">
                                <i class="fas fa-th-large text-purple-500"></i>
                                <span>{% trans 'Обзор' %}</span>
                            </a>
                            <a href="#edit" data-section="edit" class="sidebar-nav-item">
                                <i class="fas fa-edit text-blue-500"></i>
                                <span>{% trans 'Редактирование' %}</span>
                            </a>
                            <a href="#tasks" data-section="tasks" class="sidebar-nav-item">
                                <i class="fas fa-tasks text-emerald-500"></i>
                                <span>{% trans 'Задания' %}</span>
                            </a>
                            <a href="#participants" data-section="participants" class="sidebar-nav-item">
                                <i class="fas fa-users text-cyan-500"></i>
                                <span>{% trans 'Участники' %}</span>
                            </a>
                            <a href="#invitations" data-section="invitations" class="sidebar-nav-item">
                                <i class="fas fa-envelope-open-text text-teal-500"></i>
                                <span>{% trans 'Приглашения' %}</span>
                            </a>
                            <a href="#statistics" data-section="statistics" class="sidebar-nav-item">
                                <i class="fas fa-chart-line text-indigo-500"></i>
                                <span>{% trans 'Статистика' %}</span>
                            </a>
                            <a href="#reports" data-section="reports" class="sidebar-nav-item">
                                <i class="fas fa-file-export text-violet-500"></i>
                                <span>{% trans 'Отчеты' %}</span>
                            </a>
                            <a href="#status" data-section="status" class="sidebar-nav-item">
                                <i class="fas fa-power-off text-red-500"></i>
                                <span>{% trans 'Статус' %}</span>
                            </a>
                        </nav>
                    </div>
                </div>
                
                <!-- Информация об олимпиаде -->
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-750">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">{% trans 'Информация' %}</h3>
                    </div>
                    <div class="p-4 space-y-3">
                        <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                            <span class="text-gray-700 dark:text-gray-300">{% trans 'Статус:' %}</span>
                            <span class="px-2.5 py-1 rounded-full text-xs font-medium
                                {% if olympiad.status == 'draft' %}bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300
                                {% elif olympiad.status == 'published' %}bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300
                                {% elif olympiad.status == 'active' %}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300
                                {% elif olympiad.status == 'completed' %}bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300
                                {% elif olympiad.status == 'archived' %}bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300
                                {% endif %}">
                                {{ olympiad.get_status_display }}
                            </span>
                        </div>
                        <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                            <span class="text-gray-700 dark:text-gray-300">{% trans 'Создана:' %}</span>
                            <span class="text-gray-800 dark:text-gray-200">{{ olympiad.created_at|date:"d.m.Y" }}</span>
                        </div>
                        <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                            <span class="text-gray-700 dark:text-gray-300">{% trans 'Начало:' %}</span>
                            <span class="text-gray-800 dark:text-gray-200">{{ olympiad.start_datetime|date:"d.m.Y H:i" }}</span>
                        </div>
                        <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                            <span class="text-gray-700 dark:text-gray-300">{% trans 'Окончание:' %}</span>
                            <span class="text-gray-800 dark:text-gray-200">{{ olympiad.end_datetime|date:"d.m.Y H:i" }}</span>
                        </div>
                        <div class="flex items-center justify-between py-2">
                            <span class="text-gray-700 dark:text-gray-300">{% trans 'Заданий:' %}</span>
                            <span class="text-gray-800 dark:text-gray-200">{{ olympiad.tasks.count }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Правая колонка с содержимым разделов -->
        <div class="lg:col-span-3 xl:col-span-4">
            <!-- Секция: Обзор -->
            <div id="section-overview" class="content-section active">
                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                    <!-- Карточка редактирования олимпиады -->
                    <div class="olympiad-card bg-white dark:bg-gray-800 shadow-lg relative">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-500 to-blue-600 text-white">
                            <div class="flex items-center">
                                <i class="fas fa-edit text-xl mr-3"></i>
                                <h2 class="text-lg font-medium">{% trans 'Настройки олимпиады' %}</h2>
                            </div>
                        </div>
                        <div class="p-6">
                            <p class="text-gray-700 dark:text-gray-300 mb-5">{% trans 'Редактирование информации об олимпиаде, включая название, описание и даты проведения.' %}</p>
                            <a href="#edit" data-section="edit" class="btn-action inline-flex items-center px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full justify-center">
                                <i class="fas fa-pen-to-square mr-2"></i> {% trans 'Редактировать' %}
                            </a>
                        </div>
                    </div>
                    
                    <!-- Карточка управления заданиями -->
                    <div class="olympiad-card bg-white dark:bg-gray-800 shadow-lg relative">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white">
                            <div class="flex items-center">
                                <i class="fas fa-tasks text-xl mr-3"></i>
                                <h2 class="text-lg font-medium">{% trans 'Задания' %}</h2>
                            </div>
                        </div>
                        <div class="p-6">
                            <p class="text-gray-700 dark:text-gray-300 mb-5">{% trans 'Управление заданиями олимпиады, добавление новых, редактирование существующих.' %}</p>
                            <a href="#tasks" data-section="tasks" class="btn-action inline-flex items-center px-4 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors w-full justify-center">
                                <i class="fas fa-list-check mr-2"></i> {% trans 'Управление заданиями' %}
                            </a>
                        </div>
                    </div>
                    
                    <!-- Карточка управления участниками -->
                    <div class="olympiad-card bg-white dark:bg-gray-800 shadow-lg relative">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-cyan-500 to-cyan-600 text-white">
                            <div class="flex items-center">
                                <i class="fas fa-users text-xl mr-3"></i>
                                <h2 class="text-lg font-medium">{% trans 'Участники' %}</h2>
                            </div>
                            <div class="absolute top-4 right-4 bg-white/20 backdrop-blur-sm rounded-full px-2.5 py-1 text-xs font-medium">
                                {{ olympiad.participants.count }}
                            </div>
                        </div>
                        <div class="p-6">
                            <p class="text-gray-700 dark:text-gray-300 mb-5">{% trans 'Просмотр и управление списком участников олимпиады.' %}</p>
                            <a href="#participants" data-section="participants" class="btn-action inline-flex items-center px-4 py-2.5 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors w-full justify-center">
                                <i class="fas fa-user-group mr-2"></i> {% trans 'Просмотр участников' %}
                            </a>
                        </div>
                    </div>
                    
                    <!-- Карточка приглашений -->
                    <div class="olympiad-card bg-white dark:bg-gray-800 shadow-lg relative">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-teal-500 to-teal-600 text-white">
                            <div class="flex items-center">
                                <i class="fas fa-envelope-open-text text-xl mr-3"></i>
                                <h2 class="text-lg font-medium">{% trans 'Приглашения' %}</h2>
                            </div>
                        </div>
                        <div class="p-6">
                            <p class="text-gray-700 dark:text-gray-300 mb-5">{% trans 'Управление приглашениями, создание и распространение ссылок на олимпиаду.' %}</p>
                            <a href="#invitations" data-section="invitations" class="btn-action inline-flex items-center px-4 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors w-full justify-center">
                                <i class="fas fa-link mr-2"></i> {% trans 'Управление приглашениями' %}
                            </a>
                        </div>
                    </div>
                    
                    <!-- Карточка статистики -->
                    <div class="olympiad-card bg-white dark:bg-gray-800 shadow-lg relative">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white">
                            <div class="flex items-center">
                                <i class="fas fa-chart-line text-xl mr-3"></i>
                                <h2 class="text-lg font-medium">{% trans 'Статистика' %}</h2>
                            </div>
                        </div>
                        <div class="p-6">
                            <p class="text-gray-700 dark:text-gray-300 mb-5">{% trans 'Просмотр статистики по участникам, выполненным заданиям и результатам.' %}</p>
                            <a href="#statistics" data-section="statistics" class="btn-action inline-flex items-center px-4 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors w-full justify-center">
                                <i class="fas fa-chart-bar mr-2"></i> {% trans 'Просмотр статистики' %}
                            </a>
                        </div>
                    </div>
                    
                    <!-- Карточка отчетов -->
                    <div class="olympiad-card bg-white dark:bg-gray-800 shadow-lg relative">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-violet-500 to-violet-600 text-white">
                            <div class="flex items-center">
                                <i class="fas fa-file-export text-xl mr-3"></i>
                                <h2 class="text-lg font-medium">{% trans 'Отчеты' %}</h2>
                            </div>
                        </div>
                        <div class="p-6">
                            <p class="text-gray-700 dark:text-gray-300 mb-5">{% trans 'Генерация и выгрузка отчетов по результатам олимпиады, сертификатов.' %}</p>
                            <a href="#reports" data-section="reports" class="btn-action inline-flex items-center px-4 py-2.5 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors w-full justify-center">
                                <i class="fas fa-download mr-2"></i> {% trans 'Скачать отчеты' %}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Секция: Редактирование -->
            <div id="section-edit" class="content-section">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-500 to-blue-600 text-white">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-edit mr-3"></i> {% trans 'Редактирование олимпиады' %}
                        </h2>
                    </div>
                    <div class="p-6">
                        <form method="post" action="{% url 'olympiads:olympiad_edit' olympiad_id=olympiad.id %}">
                            {% csrf_token %}
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        {% trans 'Название олимпиады' %}
                                    </label>
                                    <input type="text" name="title" value="{{ olympiad.title }}" required 
                                        class="form-input block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        {% trans 'Категория' %}
                                    </label>
                                    <select name="category" class="form-input block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-blue-500 focus:border-blue-500">
                                        {% for category in categories %}
                                            <option value="{{ category.id }}" {% if olympiad.category.id == category.id %}selected{% endif %}>
                                                {{ category.name }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    {% trans 'Описание' %}
                                </label>
                                <textarea name="description" rows="4" class="form-input block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-blue-500 focus:border-blue-500">{{ olympiad.description }}</textarea>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        {% trans 'Дата и время начала' %}
                                    </label>
                                    <input type="datetime-local" name="start_datetime" value="{{ olympiad.start_datetime|date:'Y-m-d\TH:i' }}" 
                                        class="form-input block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        {% trans 'Дата и время окончания' %}
                                    </label>
                                    <input type="datetime-local" name="end_datetime" value="{{ olympiad.end_datetime|date:'Y-m-d\TH:i' }}" 
                                        class="form-input block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-blue-500 focus:border-blue-500">
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    {% trans 'Правила олимпиады' %}
                                </label>
                                <textarea name="rules" rows="6" class="form-input block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-blue-500 focus:border-blue-500">{{ olympiad.rules }}</textarea>
                            </div>
                            
                            <div class="flex justify-end">
                                <button type="submit" class="btn-action inline-flex items-center px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                    <i class="fas fa-save mr-2"></i> {% trans 'Сохранить изменения' %}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Секция: Задания -->
            <div id="section-tasks" class="content-section">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden mb-6">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white">
                        <div class="flex justify-between items-center">
                            <h2 class="text-xl font-semibold flex items-center">
                                <i class="fas fa-tasks mr-3"></i> {% trans 'Управление заданиями' %}
                            </h2>
                            <a href="{% url 'olympiads:olympiad_task_create' olympiad_id=olympiad.id %}" class="inline-flex items-center px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white transition-all">
                                <i class="fas fa-plus mr-2"></i> {% trans 'Добавить задание' %}
                            </a>
                        </div>
                    </div>
                    <div class="p-6">
                        {% if olympiad.tasks.all %}
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Название' %}
                                            </th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Сложность' %}
                                            </th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Баллы' %}
                                            </th>
                                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Действия' %}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        {% for task in olympiad.tasks.all %}
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm font-medium text-gray-900 dark:text-white">{{ task.title }}</div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                                        {% if task.difficulty == 'easy' %}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300
                                                        {% elif task.difficulty == 'medium' %}bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300
                                                        {% elif task.difficulty == 'hard' %}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300
                                                        {% endif %}">
                                                        {{ task.get_difficulty_display }}
                                                    </span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm text-gray-900 dark:text-white">{{ task.max_score }}</div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                    <div class="flex justify-end space-x-2">
                                                        <a href="{% url 'olympiads:olympiad_task_edit' olympiad_id=olympiad.id task_id=task.id %}" class="text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300">
                                                            <i class="fas fa-edit"></i>
                                                        </a>
                                                        <a href="{% url 'olympiads:olympiad_task_detail' olympiad_id=olympiad.id task_id=task.id %}" class="text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300">
                                                            <i class="fas fa-eye"></i>
                                                        </a>
                                                        <a href="{% url 'olympiads:olympiad_task_delete' olympiad_id=olympiad.id task_id=task.id %}" class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300" onclick="return confirm('{% trans 'Вы уверены, что хотите удалить это задание?' %}');">
                                                            <i class="fas fa-trash-alt"></i>
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% else %}
                            <div class="flex flex-col items-center justify-center py-12 text-center">
                                <div class="w-16 h-16 flex items-center justify-center bg-gray-100 dark:bg-gray-700 rounded-full mb-4">
                                    <i class="fas fa-tasks text-gray-400 dark:text-gray-500 text-xl"></i>
                                </div>
                                <h3 class="mb-2 text-lg font-medium text-gray-900 dark:text-white">{% trans 'Нет заданий' %}</h3>
                                <p class="text-gray-500 dark:text-gray-400 mb-6">{% trans 'В этой олимпиаде пока нет заданий. Добавьте задания, чтобы участники могли приступить к их выполнению.' %}</p>
                                <a href="{% url 'olympiads:olympiad_task_create' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i> {% trans 'Добавить первое задание' %}
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <!-- Секция: Участники -->
            <div id="section-participants" class="content-section">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-cyan-500 to-cyan-600 text-white">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-users mr-3"></i> {% trans 'Участники олимпиады' %}
                        </h2>
                    </div>
                    <div class="p-6">
                        {% if olympiad.participants.all %}
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Участник' %}
                                            </th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Дата регистрации' %}
                                            </th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Выполнено заданий' %}
                                            </th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                {% trans 'Баллы' %}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        {% for participant in olympiad.participants.all %}
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="flex items-center">
                                                        <div class="flex-shrink-0 h-10 w-10">
                                                            {% if participant.profile_image %}
                                                                <img class="h-10 w-10 rounded-full object-cover" src="{{ participant.profile_image.url }}" alt="{{ participant.username }}">
                                                            {% else %}
                                                                <div class="h-10 w-10 rounded-full flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400">
                                                                    <i class="fas fa-user"></i>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                        <div class="ml-4">
                                                            <div class="text-sm font-medium text-gray-900 dark:text-white">
                                                                {{ participant.get_full_name|default:participant.username }}
                                                            </div>
                                                            <div class="text-sm text-gray-500 dark:text-gray-400">
                                                                {{ participant.email }}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm text-gray-900 dark:text-white">
                                                        {{ participant.olympiad_registrations.get.registered_at|date:"d.m.Y H:i" }}
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm text-gray-900 dark:text-white">
                                                        {{ participant.olympiad_solutions.filter.count }} / {{ olympiad.tasks.count }}
                                                    </div>
                                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-1">
                                                        <div class="bg-cyan-600 h-1.5 rounded-full" style="width: {% widthratio participant.olympiad_solutions.filter.count olympiad.tasks.count 100 %}%"></div>
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm text-gray-900 dark:text-white">
                                                        {{ participant.olympiad_score }}
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% else %}
                            <div class="flex flex-col items-center justify-center py-12 text-center">
                                <div class="w-16 h-16 flex items-center justify-center bg-gray-100 dark:bg-gray-700 rounded-full mb-4">
                                    <i class="fas fa-users text-gray-400 dark:text-gray-500 text-xl"></i>
                                </div>
                                <h3 class="mb-2 text-lg font-medium text-gray-900 dark:text-white">{% trans 'Нет участников' %}</h3>
                                <p class="text-gray-500 dark:text-gray-400 mb-6">{% trans 'В этой олимпиаде пока нет зарегистрированных участников. Используйте раздел приглашений для привлечения участников.' %}</p>
                                <a href="#invitations" data-section="invitations" class="btn-action inline-flex items-center px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors">
                                    <i class="fas fa-link mr-2"></i> {% trans 'Управление приглашениями' %}
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <!-- Секция: Приглашения -->
            <div id="section-invitations" class="content-section">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden mb-6">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-teal-500 to-teal-600 text-white">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-envelope-open-text mr-3"></i> {% trans 'Приглашения' %}
                        </h2>
                    </div>
                    <div class="p-6">
                        <div class="mb-8">
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-3">{% trans 'Ссылка для приглашения' %}</h3>
                            <p class="text-gray-600 dark:text-gray-300 mb-4">{% trans 'Скопируйте эту ссылку и отправьте ее потенциальным участникам для регистрации на олимпиаду.' %}</p>
                            
                            <div class="flex">
                                {% if olympiad.invitation_code %}
                                    <input type="text" value="{{ request.scheme }}://{{ request.get_host }}{% url 'olympiads:olympiad_join_by_invitation' code=olympiad.invitation_code %}" id="invitation-link" class="form-input block w-full rounded-l-lg border-r-0 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white" readonly>
                                    <button type="button" onclick="copyInvitationLink()" class="inline-flex items-center px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-r-lg focus:outline-none">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                {% else %}
                                    <input type="text" value="{% trans 'Код приглашения не сгенерирован' %}" id="invitation-link" class="form-input block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-gray-500" readonly disabled>
                                    <form method="post" action="{% url 'olympiads:olympiad_generate_invitation' olympiad_id=olympiad.id %}" class="ml-2">
                                        {% csrf_token %}
                                        <button type="submit" class="inline-flex items-center px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg focus:outline-none">
                                            <i class="fas fa-key mr-2"></i> {% trans 'Сгенерировать код' %}
                                        </button>
                                    </form>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-3">{% trans 'QR-код для приглашения' %}</h3>
                            <p class="text-gray-600 dark:text-gray-300 mb-4">{% trans 'Покажите этот QR-код участникам для быстрой регистрации на олимпиаду через мобильное устройство.' %}</p>
                            
                            {% if olympiad.invitation_code %}
                                <div class="flex justify-center py-4">
                                    <img src="{% url 'olympiads:olympiad_invitation_qr' olympiad_id=olympiad.id %}" class="border border-gray-200 dark:border-gray-700 rounded-lg h-48 w-48 bg-white p-3" alt="QR-код для приглашения">
                                </div>
                                
                                <div class="flex justify-center mt-2">
                                    <a href="{% url 'olympiads:olympiad_invitation_qr' olympiad_id=olympiad.id %}" download="olympiad-invitation-qr.png" class="inline-flex items-center px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors">
                                        <i class="fas fa-download mr-2"></i> {% trans 'Скачать QR-код' %}
                                    </a>
                                </div>
                            {% else %}
                                <div class="flex flex-col items-center justify-center py-8 text-center">
                                    <div class="w-20 h-20 flex items-center justify-center bg-gray-100 dark:bg-gray-700 rounded-full mb-4">
                                        <i class="fas fa-qrcode text-gray-400 dark:text-gray-500 text-2xl"></i>
                                    </div>
                                    <p class="text-gray-500 dark:text-gray-400 mb-4">{% trans 'QR-код будет доступен после генерации кода приглашения.' %}</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Секция: Статистика -->
            <div id="section-statistics" class="content-section">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-chart-line mr-3"></i> {% trans 'Статистика олимпиады' %}
                        </h2>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center">
                                    <div class="flex items-center justify-center h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-500 dark:text-indigo-300">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="ml-4">
                                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">{% trans 'Участники' %}</h3>
                                        <p class="text-2xl font-semibold text-gray-900 dark:text-white">{{ olympiad.participants.count }}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center">
                                    <div class="flex items-center justify-center h-12 w-12 rounded-full bg-emerald-100 dark:bg-emerald-900 text-emerald-500 dark:text-emerald-300">
                                        <i class="fas fa-tasks"></i>
                                    </div>
                                    <div class="ml-4">
                                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">{% trans 'Задания' %}</h3>
                                        <p class="text-2xl font-semibold text-gray-900 dark:text-white">{{ olympiad.tasks.count }}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center">
                                    <div class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-500 dark:text-blue-300">
                                        <i class="fas fa-code"></i>
                                    </div>
                                    <div class="ml-4">
                                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">{% trans 'Решения' %}</h3>
                                        <p class="text-2xl font-semibold text-gray-900 dark:text-white">{{ solutions_count }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-8">
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">{% trans 'Лидеры олимпиады' %}</h3>
                            {% if leaders %}
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    {% trans 'Место' %}
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    {% trans 'Участник' %}
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    {% trans 'Баллы' %}
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    {% trans 'Решено задач' %}
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            {% for leader in leaders %}
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="flex items-center justify-center w-8 h-8 rounded-full 
                                                            {% if forloop.counter == 1 %}bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300
                                                            {% elif forloop.counter == 2 %}bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300
                                                            {% elif forloop.counter == 3 %}bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-300
                                                            {% else %}bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300
                                                            {% endif %}">
                                                            {{ forloop.counter }}
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="flex items-center">
                                                            <div class="flex-shrink-0 h-8 w-8">
                                                                {% if leader.profile_image %}
                                                                    <img class="h-8 w-8 rounded-full object-cover" src="{{ leader.profile_image.url }}" alt="{{ leader.username }}">
                                                                {% else %}
                                                                    <div class="h-8 w-8 rounded-full flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400">
                                                                        <i class="fas fa-user text-sm"></i>
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                            <div class="ml-3">
                                                                <div class="text-sm font-medium text-gray-900 dark:text-white">
                                                                    {{ leader.get_full_name|default:leader.username }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="text-sm font-semibold text-gray-900 dark:text-white">
                                                            {{ leader.olympiad_score }}
                                                        </div>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <div class="text-sm text-gray-900 dark:text-white">
                                                            {{ leader.olympiad_solutions.filter.count }} / {{ olympiad.tasks.count }}
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                <div class="flex flex-col items-center justify-center py-8 text-center">
                                    <div class="w-12 h-12 flex items-center justify-center bg-gray-100 dark:bg-gray-700 rounded-full mb-3">
                                        <i class="fas fa-chart-pie text-gray-400 dark:text-gray-500"></i>
                                    </div>
                                    <p class="text-gray-500 dark:text-gray-400">{% trans 'Нет данных для отображения статистики.' %}</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Секция: Отчеты -->
            <div id="section-reports" class="content-section">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-violet-500 to-violet-600 text-white">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-file-export mr-3"></i> {% trans 'Отчеты олимпиады' %}
                        </h2>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center mb-4">
                                    <div class="flex items-center justify-center h-10 w-10 rounded-full bg-violet-100 dark:bg-violet-900 text-violet-500 dark:text-violet-300">
                                        <i class="fas fa-list-ol"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium text-gray-900 dark:text-white">{% trans 'Рейтинг участников' %}</h3>
                                </div>
                                <p class="text-gray-600 dark:text-gray-300 mb-4">{% trans 'Скачайте полный список участников олимпиады с их результатами, отсортированный по набранным баллам.' %}</p>
                                <a href="{% url 'olympiads:olympiad_reports' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-4 py-2 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors">
                                    <i class="fas fa-download mr-2"></i> {% trans 'Открыть отчеты' %}
                                </a>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center mb-4">
                                    <div class="flex items-center justify-center h-10 w-10 rounded-full bg-purple-100 dark:bg-purple-900 text-purple-500 dark:text-purple-300">
                                        <i class="fas fa-chart-bar"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium text-gray-900 dark:text-white">{% trans 'Статистика заданий' %}</h3>
                                </div>
                                <p class="text-gray-600 dark:text-gray-300 mb-4">{% trans 'Скачайте детальную статистику по каждому заданию: процент решаемости, среднее количество баллов, распределение оценок.' %}</p>
                                <a href="{% url 'olympiads:olympiad_reports' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                    <i class="fas fa-chart-bar mr-2"></i> {% trans 'Открыть статистику' %}
                                </a>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center mb-4">
                                    <div class="flex items-center justify-center h-10 w-10 rounded-full bg-pink-100 dark:bg-pink-900 text-pink-500 dark:text-pink-300">
                                        <i class="fas fa-certificate"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium text-gray-900 dark:text-white">{% trans 'Сертификаты' %}</h3>
                                </div>
                                <p class="text-gray-600 dark:text-gray-300 mb-4">{% trans 'Сгенерируйте и скачайте сертификаты участников олимпиады с их результатами для дальнейшего распространения.' %}</p>
                                <a href="{% url 'olympiads:olympiad_statistics' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors">
                                    <i class="fas fa-certificate mr-2"></i> {% trans 'Сертификаты участников' %}
                                </a>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center mb-4">
                                    <div class="flex items-center justify-center h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-500 dark:text-blue-300">
                                        <i class="fas fa-file-archive"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium text-gray-900 dark:text-white">{% trans 'Полный архив' %}</h3>
                                </div>
                                <p class="text-gray-600 dark:text-gray-300 mb-4">{% trans 'Скачайте полный архив олимпиады, включающий все решения участников, задания и результаты в едином архиве.' %}</p>
                                <a href="{% url 'olympiads:olympiad_statistics' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                    <i class="fas fa-file-archive mr-2"></i> {% trans 'Просмотр файлов' %}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Секция: Статус -->
            <div id="section-status" class="content-section">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-red-500 to-red-600 text-white">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-power-off mr-3"></i> {% trans 'Управление статусом' %}
                        </h2>
                    </div>
                    <div class="p-6">
                        <div class="bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 border border-gray-200 dark:border-gray-600 mb-6">
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">{% trans 'Текущий статус олимпиады' %}</h3>
                            
                            <div class="flex items-center my-6">
                                <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5">
                                    <div class="h-2.5 rounded-full
                                        {% if olympiad.status == 'draft' %}bg-yellow-500 w-1/5
                                        {% elif olympiad.status == 'published' %}bg-blue-500 w-2/5
                                        {% elif olympiad.status == 'active' %}bg-green-500 w-3/5
                                        {% elif olympiad.status == 'completed' %}bg-purple-500 w-4/5
                                        {% elif olympiad.status == 'archived' %}bg-gray-500 w-full
                                        {% endif %}"></div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-5 text-center text-xs gap-1">
                                <div class="{% if olympiad.status == 'draft' %}font-semibold text-yellow-600 dark:text-yellow-400{% else %}text-gray-500 dark:text-gray-400{% endif %}">
                                    <div class="w-5 h-5 mx-auto mb-1 rounded-full flex items-center justify-center 
                                        {% if olympiad.status == 'draft' %}bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300 border-2 border-yellow-400
                                        {% elif olympiad.status_index > 0 %}bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300
                                        {% else %}bg-gray-200 text-gray-400 dark:bg-gray-700 dark:text-gray-500{% endif %}">
                                        <i class="fas fa-pencil-alt text-xs"></i>
                                    </div>
                                    {% trans 'Черновик' %}
                                </div>
                                <div class="{% if olympiad.status == 'published' %}font-semibold text-blue-600 dark:text-blue-400{% else %}text-gray-500 dark:text-gray-400{% endif %}">
                                    <div class="w-5 h-5 mx-auto mb-1 rounded-full flex items-center justify-center 
                                        {% if olympiad.status == 'published' %}bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300 border-2 border-blue-400
                                        {% elif olympiad.status_index > 1 %}bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300
                                        {% else %}bg-gray-200 text-gray-400 dark:bg-gray-700 dark:text-gray-500{% endif %}">
                                        <i class="fas fa-paper-plane text-xs"></i>
                                    </div>
                                    {% trans 'Опубликована' %}
                                </div>
                                <div class="{% if olympiad.status == 'active' %}font-semibold text-green-600 dark:text-green-400{% else %}text-gray-500 dark:text-gray-400{% endif %}">
                                    <div class="w-5 h-5 mx-auto mb-1 rounded-full flex items-center justify-center 
                                        {% if olympiad.status == 'active' %}bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300 border-2 border-green-400
                                        {% elif olympiad.status_index > 2 %}bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300
                                        {% else %}bg-gray-200 text-gray-400 dark:bg-gray-700 dark:text-gray-500{% endif %}">
                                        <i class="fas fa-play text-xs"></i>
                                    </div>
                                    {% trans 'Активна' %}
                                </div>
                                <div class="{% if olympiad.status == 'completed' %}font-semibold text-purple-600 dark:text-purple-400{% else %}text-gray-500 dark:text-gray-400{% endif %}">
                                    <div class="w-5 h-5 mx-auto mb-1 rounded-full flex items-center justify-center 
                                        {% if olympiad.status == 'completed' %}bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-300 border-2 border-purple-400
                                        {% elif olympiad.status_index > 3 %}bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-300
                                        {% else %}bg-gray-200 text-gray-400 dark:bg-gray-700 dark:text-gray-500{% endif %}">
                                        <i class="fas fa-check text-xs"></i>
                                    </div>
                                    {% trans 'Завершена' %}
                                </div>
                                <div class="{% if olympiad.status == 'archived' %}font-semibold text-gray-600 dark:text-gray-400{% else %}text-gray-500 dark:text-gray-400{% endif %}">
                                    <div class="w-5 h-5 mx-auto mb-1 rounded-full flex items-center justify-center 
                                        {% if olympiad.status == 'archived' %}bg-gray-200 text-gray-600 dark:bg-gray-600 dark:text-gray-300 border-2 border-gray-400
                                        {% else %}bg-gray-200 text-gray-400 dark:bg-gray-700 dark:text-gray-500{% endif %}">
                                        <i class="fas fa-archive text-xs"></i>
                                    </div>
                                    {% trans 'Архивирована' %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">{% trans 'Изменить статус' %}</h3>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <a href="{% url 'olympiads:olympiad_publish' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                        <i class="fas fa-paper-plane mr-1"></i> {% trans 'Опубликовать' %}
                                    </a>
                                    <a href="{% url 'olympiads:olympiad_activate' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                        <i class="fas fa-play mr-1"></i> {% trans 'Активировать' %}
                                    </a>
                                    <a href="{% url 'olympiads:olympiad_complete' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                        <i class="fas fa-check mr-1"></i> {% trans 'Завершить' %}
                                    </a>
                                    <a href="{% url 'olympiads:olympiad_archive' olympiad_id=olympiad.id %}" class="btn-action inline-flex items-center px-3 py-1.5 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-archive mr-1"></i> {% trans 'Архивировать' %}
                                    </a>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">{% trans 'Удаление олимпиады' %}</h3>
                                <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-4">
                                    <div class="flex items-start">
                                        <div class="flex-shrink-0">
                                            <i class="fas fa-exclamation-triangle text-red-600 dark:text-red-400"></i>
                                        </div>
                                        <div class="ml-3">
                                            <h3 class="text-sm font-medium text-red-800 dark:text-red-300">
                                                {% trans 'Внимание! Это действие необратимо' %}
                                            </h3>
                                            <div class="mt-2 text-sm text-red-700 dark:text-red-200">
                                                <p>{% trans 'Удаление олимпиады приведет к полному удалению всех связанных данных, включая задания, решения участников и результаты.' %}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <a href="#" onclick="if(confirm('{% trans 'Вы уверены, что хотите удалить эту олимпиаду? Это действие нельзя отменить.' %}')) { window.location.href='{% url 'olympiads:olympiad_edit' olympiad_id=olympiad.id %}'; } return false;" class="btn-action inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
                                    <i class="fas fa-trash-alt mr-2"></i> {% trans 'Удалить олимпиаду' %}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Скрипт для работы навигации -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Выбираем все навигационные ссылки в сайдбаре
    const navLinks = document.querySelectorAll('.sidebar-nav-item');
    
    // Выбираем все разделы контента
    const contentSections = document.querySelectorAll('.content-section');
    
    // Скрываем все секции при загрузке страницы
    contentSections.forEach(section => {
        section.style.display = 'none';
    });
    
    // Показываем раздел "Обзор" по умолчанию
    const defaultSection = document.getElementById('section-overview');
    if (defaultSection) {
        defaultSection.style.display = 'block';
        defaultSection.classList.add('active');
    }
    
    // Активируем ссылку "Обзор" по умолчанию
    const defaultLink = document.querySelector('.sidebar-nav-item[data-section="overview"]');
    if (defaultLink) {
        defaultLink.classList.add('active');
    }
    
    // Назначаем обработчики событий для навигационных ссылок
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Получаем идентификатор раздела из атрибута data-section
            const sectionId = this.getAttribute('data-section');
            
            // Вызываем функцию переключения секций
            showSection(sectionId);
            
            // Обновляем URL с якорем для сохранения состояния навигации
            const baseUrl = window.location.href.split('#')[0];
            window.history.pushState({section: sectionId}, '', baseUrl + '#' + sectionId);
        });
    });
    
    // Проверяем якорь в URL при загрузке страницы
    if (window.location.hash) {
        const section = window.location.hash.substring(1);
        showSection(section);
    }
    
    // Обработчик для кнопки "Назад" в браузере
    window.addEventListener('popstate', function(e) {
        if (e.state && e.state.section) {
            showSection(e.state.section);
        } else {
            showSection('overview');
        }
    });
    
    // Функция для переключения секций
    function showSection(sectionId) {
        console.log('Переключение на секцию:', sectionId);
        
        // Удаляем класс active у всех навигационных ссылок
        navLinks.forEach(link => {
            link.classList.remove('active');
        });
        
        // Скрываем все секции
        contentSections.forEach(section => {
            section.classList.remove('active');
            section.style.display = 'none';
        });
        
        // Активируем выбранную навигационную ссылку
        const activeLink = document.querySelector(`.sidebar-nav-item[data-section="${sectionId}"]`);
        if (activeLink) {
            activeLink.classList.add('active');
        } else {
            console.warn('Навигационная ссылка не найдена:', sectionId);
        }
        
        // Показываем выбранную секцию
        const activeSection = document.getElementById('section-' + sectionId);
        if (activeSection) {
            activeSection.classList.add('active');
            activeSection.style.display = 'block';
            
            // Обновляем хлебные крошки
            updateBreadcrumbs(sectionId);
        } else {
            console.warn('Секция не найдена:', sectionId);
        }
        
        // Плавная прокрутка к началу контента
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }
    
    // Функция для обновления хлебных крошек
    function updateBreadcrumbs(sectionId) {
        const sectionName = document.querySelector(`.sidebar-nav-item[data-section="${sectionId}"]`)?.textContent.trim() || 'Управление';
        const breadcrumbCurrent = document.getElementById('breadcrumb-current');
        if (breadcrumbCurrent) {
            breadcrumbCurrent.textContent = sectionName;
        }
    }
});

// Функция для копирования ссылки-приглашения в буфер обмена
function copyInvitationLink() {
    const invitationLink = document.getElementById('invitation-link');
    if (invitationLink) {
        invitationLink.select();
        document.execCommand('copy');
        
        // Создаем и показываем всплывающее уведомление
        const toast = document.createElement('div');
        toast.className = 'notification-toast bg-green-500 text-white';
        toast.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Ссылка скопирована в буфер обмена';
        document.body.appendChild(toast);
        
        // Удаляем уведомление через 3 секунды
        setTimeout(() => {
            toast.remove();
        }, 3000);
    }
}
</script>
{% endblock %}